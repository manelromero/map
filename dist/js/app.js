var Location=function(e,o,n){this.name=ko.observable(e.name),this.address=ko.observable(e.address),this.show=ko.observable(e.show),this.position=ko.observable(e.position),this.marker=o,this.infoWindow=n},ViewModel=function(){function e(){document.getElementById("map").style.height=window.innerHeight-60+"px"}var o=this,n=document.getElementById("filter-field");this.filterText=ko.observable(),this.allLocations=ko.observableArray([]),e(),window.onresize=function(){e()},this.map=new google.maps.Map(document.getElementById("map"),{center:{lat:41.387537,lng:2.168632},zoom:13}),this.drawMap=function(){map||(document.getElementById("map").innerHTML="Sorry, map could not be loaded"),mapLocations.forEach(function(e){var n=new google.maps.Marker({position:e.position,map:o.map,title:e.name}),t='<div class="map-name">'+e.name+'</div><div class="map-address">'+e.address+'</div><div><a class="info-link" name="'+n.title+'">+info</a></div>',i=new google.maps.InfoWindow({content:t});n.addListener("click",function(){var e=i.anchor;"undefined"==typeof e||null===e?(i.open(o.map,n),modalWindow(n.title),o.bounce(n)):i.close()}),o.allLocations.push(new Location(e,n,i))})},n.addEventListener("input",function(){o.filterText(this.value.toLowerCase())}),this.toggleInfo=function(e){google.maps.event.trigger(e.marker,"click")},this.bounce=function(e){if(e.hasOwnProperty("marker"))var o=e.marker;else var o=e;o.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.setAnimation(null)},750)},this.filterLocations=ko.computed(function(){var e=o.filterText()||"";o.allLocations().forEach(function(n){var t=n.name().toLowerCase();-1==t.indexOf(e)?(n.show(!1),n.marker.setMap(null)):(n.show(!0),n.marker.setMap(o.map))})}),this.drawMap()};ko.applyBindings(new ViewModel);